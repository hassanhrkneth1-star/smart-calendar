<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmartCal - Intelligent Calendar</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&display=swap">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* Black background theme */
            --bg-primary: #000000;
            --bg-secondary: #0a0a0a;
            --bg-tertiary: #141414;
            --bg-card: rgba(20, 20, 20, 0.8);
            
            /* Groovy earthy palette */
            --color-tan: #F3DFCD;
            --color-olive: #C1C39D;
            --color-orange: #FAAF6F;
            --color-rose: #F3B2A6;
            --color-slate: #BEC8D3;
            --color-purple: #ACA0BD;
            --color-brown: #E5A082;
            --color-gold: #EDC483;
            --color-sage: #B5BFB6;
            --color-taupe: #E1B9A1;
            
            /* Default task color (based on image - appears to be orange) */
            --default-task: #FAAF6F;
            
            /* Urgency colors with palette integration */
            --critical: #F3B2A6;
            --high: #FAAF6F;
            --medium: #ACA0BD;
            --low: #B5BFB6;
            
            /* Text colors */
            --text-primary: #F3DFCD;
            --text-secondary: #C1C39D;
            --text-muted: #7a7a7a;
            
            /* UI elements */
            --border-subtle: rgba(243, 223, 205, 0.1);
            --glass-bg: rgba(20, 20, 20, 0.7);
            --glass-border: rgba(243, 223, 205, 0.15);
            --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.5);
            --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.6);
            --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.7);
            --shadow-glow: 0 0 20px rgba(250, 175, 111, 0.3);
        }

        body {
            font-family: 'Outfit', sans-serif;
            background: #000000;
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 30%, rgba(250, 175, 111, 0.08) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(181, 191, 182, 0.06) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        .app-container {
            display: flex;
            min-height: 100vh;
            position: relative;
            z-index: 1;
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border-right: 1px solid var(--glass-border);
            padding: 2rem 1.5rem;
            display: flex;
            flex-direction: column;
            position: sticky;
            top: 0;
            height: 100vh;
            box-shadow: var(--shadow-md);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 3rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid var(--border-subtle);
        }

        .logo-icon {
            font-size: 2rem;
            filter: drop-shadow(0 0 10px rgba(255, 107, 53, 0.5));
        }

        .logo h1 {
            font-size: 1.75rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--color-orange) 0%, var(--color-gold) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: -0.5px;
        }

        .nav-links {
            list-style: none;
            flex: 1;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 0.875rem;
            padding: 0.875rem 1.25rem;
            margin-bottom: 0.5rem;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 500;
            font-size: 0.95rem;
            color: var(--text-secondary);
            position: relative;
            overflow: hidden;
        }

        .nav-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(250, 175, 111, 0.1) 0%, rgba(237, 196, 131, 0.1) 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .nav-item:hover {
            color: var(--text-primary);
            transform: translateX(4px);
        }

        .nav-item:hover::before {
            opacity: 1;
        }

        .nav-item.active {
            background: linear-gradient(135deg, var(--color-orange) 0%, var(--color-gold) 100%);
            color: #000000;
            box-shadow: var(--shadow-glow);
        }

        .nav-item.active::before {
            opacity: 0;
        }

        .nav-item .icon {
            font-size: 1.25rem;
            position: relative;
            z-index: 1;
        }

        .nav-footer {
            padding-top: 2rem;
            border-top: 1px solid var(--border-subtle);
        }

        /* Buttons */
        .btn {
            padding: 0.875rem 1.5rem;
            border: none;
            border-radius: 12px;
            font-family: 'Outfit', sans-serif;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transform: translate(-50%, -50%);
            transition: width 0.6s ease, height 0.6s ease;
        }

        .btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--color-orange) 0%, var(--color-gold) 100%);
            color: #000000;
            box-shadow: var(--shadow-md);
            font-weight: 700;
        }

        .btn-primary:hover {
            box-shadow: var(--shadow-glow);
            transform: translateY(-2px);
        }

        .btn-primary:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid var(--glass-border);
        }

        .btn-secondary:hover {
            background: var(--bg-secondary);
            border-color: var(--color-orange);
            box-shadow: var(--shadow-md);
        }

        .btn .icon {
            font-size: 1.1rem;
            position: relative;
            z-index: 1;
        }

        .btn span {
            position: relative;
            z-index: 1;
        }

        .w-100 { width: 100%; }
        .mt-sm { margin-top: 0.75rem; }

        .btn-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            background: var(--bg-tertiary);
            border: 1px solid var(--glass-border);
            color: var(--text-primary);
            font-size: 1.25rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .btn-icon:hover {
            background: var(--color-orange);
            border-color: var(--color-orange);
            box-shadow: var(--shadow-glow);
            transform: scale(1.05);
            color: #000000;
        }

        .btn-toggle {
            padding: 0.5rem 1.25rem;
            border-radius: 8px;
            background: transparent;
            border: 1px solid var(--border-subtle);
            color: var(--text-secondary);
            font-family: 'Outfit', sans-serif;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-toggle:hover {
            border-color: var(--color-orange);
            color: var(--text-primary);
        }

        .btn-toggle.active {
            background: linear-gradient(135deg, var(--color-orange) 0%, var(--color-gold) 100%);
            border-color: transparent;
            color: #000000;
            box-shadow: var(--shadow-sm);
            font-weight: 700;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            padding: 2rem;
            overflow-y: auto;
        }

        .view-section {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .view-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .view-header {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 1.5rem 2rem;
            margin-bottom: 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--shadow-sm);
        }

        .view-header h2 {
            font-size: 1.75rem;
            font-weight: 700;
            letter-spacing: -0.5px;
        }

        .view-controls {
            display: flex;
            gap: 0.5rem;
        }

        .flex { display: flex; }
        .items-center { align-items: center; }
        .gap-md { gap: 1rem; }
        .gap-sm { gap: 0.5rem; }
        .justify-between { justify-content: space-between; }

        /* Calendar */
        .calendar-grid {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 2rem;
            box-shadow: var(--shadow-sm);
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 1px;
            overflow: hidden;
        }

        .calendar-day-header {
            padding: 1rem;
            text-align: center;
            background: rgba(30, 41, 59, 0.5);
            color: var(--text-muted);
            font-size: 0.875rem;
            font-weight: 600;
            border-radius: 8px;
            margin-bottom: 0.5rem;
        }

        .calendar-day {
            min-height: 120px;
            background: rgba(15, 23, 42, 0.4);
            padding: 0.75rem;
            border-radius: 8px;
            transition: all 0.2s;
            border: 1px solid transparent;
        }

        .calendar-day:hover {
            background: rgba(30, 41, 59, 0.6);
            border-color: var(--accent-primary);
        }

        .calendar-day.today {
            background: rgba(250, 175, 111, 0.1);
            border-color: var(--color-orange);
        }

        .day-number {
            font-size: 0.875rem;
            color: var(--text-muted);
            margin-bottom: 0.5rem;
            display: block;
            text-align: center;
            font-weight: 600;
        }

        .calendar-day.today .day-number {
            color: var(--color-orange);
            font-weight: 700;
        }

        /* Week View Styles */
        .week-view-grid {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 1rem;
            box-shadow: var(--shadow-sm);
            display: grid;
            gap: 1px;
            overflow-x: auto;
        }

        .week-time-header {
            background: rgba(30, 41, 59, 0.5);
            padding: 1rem;
            text-align: center;
            font-weight: 600;
            color: var(--text-muted);
            border-radius: 8px;
            margin-bottom: 0.5rem;
        }

        .week-day-header {
            background: rgba(30, 41, 59, 0.5);
            padding: 1rem;
            text-align: center;
            border-radius: 8px;
            margin-bottom: 0.5rem;
            color: var(--text-secondary);
        }

        .week-day-header.today {
            background: rgba(250, 175, 111, 0.2);
            border: 1px solid var(--color-orange);
            color: var(--color-orange);
        }

        .week-time-slot {
            background: rgba(30, 41, 59, 0.3);
            padding: 0.75rem;
            text-align: right;
            font-size: 0.875rem;
            color: var(--text-muted);
            border-radius: 6px;
        }

        .week-slot {
            background: rgba(15, 23, 42, 0.4);
            padding: 0.5rem;
            border-radius: 6px;
            min-height: 60px;
            transition: all 0.2s;
            border: 1px solid transparent;
        }

        .week-slot:hover {
            background: rgba(30, 41, 59, 0.6);
            border-color: var(--color-orange);
        }

        .week-slot.today-slot {
            background: rgba(250, 175, 111, 0.05);
        }

        /* Day View Styles */
        .day-view-grid {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 1rem;
            box-shadow: var(--shadow-sm);
            display: grid;
            gap: 1px;
        }

        .day-time-slot {
            background: rgba(30, 41, 59, 0.3);
            padding: 1rem 0.75rem;
            text-align: right;
            font-size: 0.875rem;
            color: var(--text-muted);
            border-radius: 6px;
            font-weight: 600;
        }

        .day-slot {
            background: rgba(15, 23, 42, 0.4);
            padding: 1rem;
            border-radius: 6px;
            min-height: 80px;
            transition: all 0.2s;
            border: 1px solid transparent;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .day-slot:hover {
            background: rgba(30, 41, 59, 0.6);
            border-color: var(--color-orange);
        }

        .event-pill {
            font-size: 0.7rem;
            padding: 4px 6px;
            padding-right: 24px;
            border-radius: 6px;
            margin-bottom: 4px;
            background: var(--accent-primary);
            color: white;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .event-pill:hover {
            transform: translateX(2px);
            box-shadow: var(--shadow-sm);
        }

        .event-pill-content {
            flex: 1;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .event-delete-btn {
            position: absolute;
            right: 2px;
            top: 50%;
            transform: translateY(-50%);
            width: 18px;
            height: 18px;
            border-radius: 4px;
            background: rgba(0, 0, 0, 0.3);
            border: none;
            color: white;
            font-size: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: all 0.2s;
            z-index: 10;
        }

        .event-pill:hover .event-delete-btn {
            opacity: 1;
        }

        .event-delete-btn:hover {
            background: var(--critical);
            transform: translateY(-50%) scale(1.1);
        }

        .task-pill {
            background: rgba(59, 130, 246, 0.8);
            border-left: 3px solid var(--medium);
        }

        .task-pill.urgent {
            border-left-color: var(--critical);
            background: rgba(239, 68, 68, 0.3);
        }

        /* Task List */
        .task-list-container {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 2rem;
            box-shadow: var(--shadow-sm);
        }

        .task-item {
            background: rgba(26, 32, 48, 0.6);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            padding: 1.25rem;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
        }

        .task-item:hover {
            background: rgba(30, 41, 59, 0.7);
            transform: translateX(4px);
            box-shadow: var(--shadow-md);
        }

        .task-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 0.75rem;
        }

        .task-description {
            font-size: 1rem;
            font-weight: 500;
            color: var(--text-primary);
            flex: 1;
        }

        .task-meta {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        .task-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 0.75rem;
        }

        .btn-sm {
            padding: 0.375rem 0.75rem;
            font-size: 0.75rem;
            border-radius: 6px;
        }

        /* Filter Controls */
        .filter-controls {
            display: flex;
            gap: 0.5rem;
        }

        .badge {
            padding: 0.4rem 0.875rem;
            border-radius: 8px;
            font-size: 0.75rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            background: var(--bg-tertiary);
            color: var(--text-secondary);
            border: 1px solid var(--border-subtle);
        }

        .badge:hover {
            color: var(--text-primary);
            border-color: var(--color-orange);
        }

        .badge-active {
            background: linear-gradient(135deg, var(--color-orange) 0%, var(--color-gold) 100%);
            color: #000000;
            border-color: transparent;
            font-weight: 700;
        }

        .badge-critical {
            background: rgba(243, 178, 166, 0.2);
            color: var(--critical);
            border: 1px solid rgba(243, 178, 166, 0.3);
        }

        .badge-high {
            background: rgba(250, 175, 111, 0.2);
            color: var(--high);
            border: 1px solid rgba(250, 175, 111, 0.3);
        }

        .badge-medium {
            background: rgba(172, 160, 189, 0.2);
            color: var(--medium);
            border: 1px solid rgba(172, 160, 189, 0.3);
        }

        .badge-low {
            background: rgba(181, 191, 182, 0.2);
            color: var(--low);
            border: 1px solid rgba(181, 191, 182, 0.3);
        }

        /* Category Color Badges */
        .category-work { background: var(--color-orange); color: #000; }
        .category-personal { background: var(--color-sage); color: #000; }
        .category-health { background: var(--color-rose); color: #000; }
        .category-finance { background: var(--color-gold); color: #000; }
        .category-creative { background: var(--color-purple); color: #fff; }
        .category-learning { background: var(--color-slate); color: #000; }
        .category-social { background: var(--color-tan); color: #000; }
        .category-errands { background: var(--color-olive); color: #000; }
        .category-family { background: var(--color-brown); color: #000; }
        .category-other { background: var(--color-taupe); color: #000; }

        .category-selector {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 0.5rem;
            margin: 1rem 0;
        }

        .category-option {
            aspect-ratio: 1;
            border-radius: 12px;
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            position: relative;
        }

        .category-option:hover {
            transform: scale(1.1);
            box-shadow: var(--shadow-md);
        }

        .category-option.selected {
            border-color: var(--text-primary);
            box-shadow: 0 0 0 3px rgba(243, 223, 205, 0.3);
        }

        .category-label {
            position: absolute;
            bottom: -1.5rem;
            font-size: 0.65rem;
            color: var(--text-muted);
            text-align: center;
            width: 100%;
        }

        /* Dashboard */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
        }

        .stat-card, .chart-card, .recommendations-card {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 2rem;
            box-shadow: var(--shadow-sm);
            transition: all 0.3s ease;
        }

        .stat-card:hover, .chart-card:hover, .recommendations-card:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-4px);
        }

        .stat-card h3, .chart-card h3, .recommendations-card h3 {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--color-orange) 0%, var(--color-gold) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
        }

        .stat-label {
            color: var(--text-muted);
            font-size: 0.875rem;
        }

        .span-full {
            grid-column: 1 / -1;
        }

        .chart-container {
            height: 200px;
            display: flex;
            align-items: flex-end;
            gap: 10px;
            padding: 10px;
            background: rgba(15, 23, 42, 0.4);
            border-radius: 12px;
        }

        .rec-item {
            background: rgba(26, 32, 48, 0.6);
            border: 1px solid var(--glass-border);
            border-radius: 10px;
            padding: 1rem;
            margin-bottom: 0.75rem;
            font-size: 0.875rem;
        }

        .rec-item.warning {
            border-color: var(--critical);
            background: rgba(243, 178, 166, 0.1);
        }

        .rec-item.success {
            border-color: var(--low);
            background: rgba(181, 191, 182, 0.1);
        }

        /* Modal */
        .modal-backdrop {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(8px);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease;
        }

        .modal-backdrop.active {
            display: flex;
        }

        .modal {
            background: var(--bg-secondary);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            width: 90%;
            max-width: 600px;
            box-shadow: var(--shadow-lg);
            animation: slideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(40px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .modal-header {
            padding: 2rem 2rem 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--border-subtle);
        }

        .modal-header h3 {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .btn-close {
            width: 36px;
            height: 36px;
            border-radius: 8px;
            background: transparent;
            border: none;
            color: var(--text-secondary);
            font-size: 1.75rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .btn-close:hover {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .modal-body {
            padding: 2rem;
        }

        .modal-footer {
            padding: 1rem 2rem 2rem;
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
        }

        /* Forms */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--text-secondary);
            font-size: 0.875rem;
            font-weight: 500;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 0.875rem 1.25rem;
            background: var(--bg-tertiary);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            color: var(--text-primary);
            font-family: 'Outfit', sans-serif;
            font-size: 0.95rem;
            transition: all 0.3s ease;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--color-orange);
            box-shadow: 0 0 0 3px rgba(250, 175, 111, 0.1);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .analysis-box {
            background: var(--bg-tertiary);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            padding: 1.25rem;
            margin-top: 1rem;
        }

        .analysis-box.hidden {
            display: none;
        }

        .mb-sm { margin-bottom: 0.75rem; }
        .text-sm { font-size: 0.875rem; }
        .text-xs { font-size: 0.75rem; }
        .text-muted { color: var(--text-muted); }
        .hidden { display: none; }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
                height: auto;
                position: relative;
                border-right: none;
                border-bottom: 1px solid var(--glass-border);
            }

            .app-container {
                flex-direction: column;
            }

            .main-content {
                padding: 1rem;
            }

            .view-header {
                flex-direction: column;
                gap: 1rem;
                align-items: flex-start;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
            }
        }

        .animate-fade-in {
            animation: fadeIn 0.5s ease;
        }

        .empty-state {
            text-align: center;
            padding: 3rem;
            color: var(--text-muted);
        }

        /* Success Modal */
        .success-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.9);
            background: var(--bg-secondary);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 2.5rem;
            max-width: 500px;
            width: 90%;
            box-shadow: var(--shadow-lg);
            z-index: 2000;
            opacity: 0;
            pointer-events: none;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .success-modal.active {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1);
            pointer-events: all;
        }

        .success-icon {
            width: 80px;
            height: 80px;
            margin: 0 auto 1.5rem;
            background: linear-gradient(135deg, var(--color-orange) 0%, var(--color-gold) 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            animation: successPop 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            box-shadow: var(--shadow-glow);
            color: #000000;
        }

        @keyframes successPop {
            0% { transform: scale(0); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .success-content {
            text-align: center;
        }

        .success-title {
            font-size: 1.75rem;
            font-weight: 700;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, var(--color-orange) 0%, var(--color-gold) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .success-details {
            background: var(--bg-tertiary);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1.5rem 0;
        }

        .success-detail-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 0;
            border-bottom: 1px solid var(--border-subtle);
        }

        .success-detail-row:last-child {
            border-bottom: none;
        }

        .success-detail-label {
            color: var(--text-muted);
            font-size: 0.875rem;
        }

        .success-detail-value {
            color: var(--text-primary);
            font-weight: 600;
            font-size: 1rem;
        }

        .success-reason {
            background: rgba(250, 175, 111, 0.1);
            border: 1px solid rgba(250, 175, 111, 0.3);
            border-radius: 10px;
            padding: 1rem;
            margin: 1rem 0;
            font-size: 0.875rem;
            color: var(--text-secondary);
            line-height: 1.6;
        }

        .success-actions {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        /* Edit/Delete Actions for Calendar Items */
        .event-actions {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            background: var(--bg-secondary);
            border: 1px solid var(--glass-border);
            border-radius: 8px;
            padding: 0.5rem;
            margin-top: 0.25rem;
            box-shadow: var(--shadow-lg);
            z-index: 1000;
            min-width: 120px;
        }

        .event-actions.active {
            display: block;
        }

        .event-action-btn {
            width: 100%;
            padding: 0.5rem 0.75rem;
            background: transparent;
            border: none;
            color: var(--text-primary);
            font-family: 'Outfit', sans-serif;
            font-size: 0.875rem;
            cursor: pointer;
            text-align: left;
            border-radius: 6px;
            transition: all 0.2s;
            display: block;
        }

        .event-action-btn:hover {
            background: var(--bg-tertiary);
        }

        .event-action-btn.delete {
            color: var(--critical);
        }

        .event-action-btn.delete:hover {
            background: rgba(239, 68, 68, 0.1);
        }

        .calendar-day {
            position: relative;
        }

        .event-pill {
            position: relative;
            z-index: 1;
        }

        .event-pill:hover {
            z-index: 10;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <nav class="sidebar">
            <div class="logo">
                <span class="logo-icon">üìÖ</span>
                <h1>SmartCal</h1>
            </div>
            <ul class="nav-links">
                <li class="nav-item active" data-view="calendar">
                    <span class="icon">üóìÔ∏è</span> Calendar
                </li>
                <li class="nav-item" data-view="tasks">
                    <span class="icon">‚úÖ</span> Tasks
                </li>
                <li class="nav-item" data-view="dashboard">
                    <span class="icon">üìä</span> Dashboard
                </li>
            </ul>
            <div class="nav-footer">
                <button class="btn btn-primary w-100" id="btn-add-task">
                    <span class="icon">+</span>
                    <span>New Task</span>
                </button>
                <button class="btn btn-secondary w-100 mt-sm" id="btn-add-meeting">
                    <span class="icon">+</span>
                    <span>New Meeting</span>
                </button>
            </div>
        </nav>
        
        <!-- Main Content -->
        <main class="main-content">
            <!-- Calendar View -->
            <section id="calendar-view" class="view-section active">
                <header class="view-header">
                    <div class="flex items-center gap-md">
                        <button class="btn-icon" id="cal-prev">‚Üê</button>
                        <h2 id="current-month-display">February 2026</h2>
                        <button class="btn-icon" id="cal-next">‚Üí</button>
                    </div>
                    <div class="view-controls">
                        <button class="btn-toggle active" data-cal-view="month">Month</button>
                        <button class="btn-toggle" data-cal-view="week">Week</button>
                        <button class="btn-toggle" data-cal-view="day">Day</button>
                    </div>
                </header>
                <div id="calendar-grid" class="calendar-grid animate-fade-in"></div>
            </section>
            
            <!-- Tasks View -->
            <section id="tasks-view" class="view-section">
                <header class="view-header">
                    <h2>My Tasks</h2>
                    <div class="filter-controls">
                        <span class="badge badge-active" data-filter="all">All</span>
                        <span class="badge" data-filter="pending">Pending</span>
                        <span class="badge" data-filter="scheduled">Scheduled</span>
                        <span class="badge" data-filter="completed">Completed</span>
                    </div>
                </header>
                <div id="task-list" class="task-list-container animate-fade-in"></div>
            </section>
            
            <!-- Dashboard View -->
            <section id="dashboard-view" class="view-section">
                <header class="view-header">
                    <h2>Productivity Dashboard</h2>
                </header>
                <div class="dashboard-grid animate-fade-in">
                    <div class="stat-card">
                        <h3>Weekly Focus</h3>
                        <div id="stat-weekly-hours" class="stat-value">0h</div>
                        <p class="stat-label">Scheduled Work</p>
                    </div>
                    <div class="stat-card">
                        <h3>Completion Rate</h3>
                        <div id="stat-completion" class="stat-value">0%</div>
                    </div>
                    <div class="stat-card">
                        <h3>Upcoming Deadline</h3>
                        <div id="stat-next-deadline" class="stat-value text-sm">-</div>
                    </div>
                    <div class="chart-card span-full">
                        <h3>Workload Intensity</h3>
                        <div id="intensity-chart" class="chart-container"></div>
                    </div>
                    <div class="recommendations-card span-full">
                        <h3>üí° Smart Recommendations</h3>
                        <div id="recommendations-list"></div>
                    </div>
                </div>
            </section>
        </main>
    </div>
    
    <!-- Task Modal -->
    <div class="modal-backdrop" id="task-modal">
        <div class="modal">
            <div class="modal-header">
                <h3>New Task</h3>
                <button class="btn-close" data-close="task">√ó</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>What do you need to do?</label>
                    <textarea id="task-input" rows="3" placeholder="e.g. 'Prepare slides for Friday's client meeting'"></textarea>
                </div>
                
                <div class="form-group">
                    <label>Category</label>
                    <div class="category-selector">
                        <div class="category-option category-work" data-category="work" title="Work">
                            üíº<span class="category-label">Work</span>
                        </div>
                        <div class="category-option category-personal selected" data-category="personal" title="Personal">
                            üè†<span class="category-label">Personal</span>
                        </div>
                        <div class="category-option category-health" data-category="health" title="Health">
                            ‚ù§Ô∏è<span class="category-label">Health</span>
                        </div>
                        <div class="category-option category-finance" data-category="finance" title="Finance">
                            üí∞<span class="category-label">Finance</span>
                        </div>
                        <div class="category-option category-creative" data-category="creative" title="Creative">
                            üé®<span class="category-label">Creative</span>
                        </div>
                        <div class="category-option category-learning" data-category="learning" title="Learning">
                            üìö<span class="category-label">Learning</span>
                        </div>
                        <div class="category-option category-social" data-category="social" title="Social">
                            üë•<span class="category-label">Social</span>
                        </div>
                        <div class="category-option category-errands" data-category="errands" title="Errands">
                            üõí<span class="category-label">Errands</span>
                        </div>
                        <div class="category-option category-family" data-category="family" title="Family">
                            üë®‚Äçüë©‚Äçüëß<span class="category-label">Family</span>
                        </div>
                        <div class="category-option category-other" data-category="other" title="Other">
                            üìå<span class="category-label">Other</span>
                        </div>
                    </div>
                </div>
                
                <div id="analysis-preview" class="analysis-box hidden">
                    <div class="flex justify-between items-center mb-sm">
                        <span class="badge" id="preview-urgency">Medium</span>
                        <span class="badge" id="preview-type">General</span>
                        <span class="text-xs text-muted" id="preview-effort">1h</span>
                    </div>
                    <p class="text-sm" id="preview-suggestion"></p>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Hard Deadline (Optional)</label>
                        <input type="date" id="task-deadline">
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="btn-cancel-task">Cancel</button>
                <button class="btn btn-primary" id="btn-save-task">Schedule Task</button>
            </div>
        </div>
    </div>
    
    <!-- Meeting Modal -->
    <div class="modal-backdrop" id="meeting-modal">
        <div class="modal">
            <div class="modal-header">
                <h3>New Meeting</h3>
                <button class="btn-close" data-close="meeting">√ó</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Title</label>
                    <input type="text" id="meeting-title" placeholder="Meeting Title">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Date</label>
                        <input type="date" id="meeting-date">
                    </div>
                    <div class="form-group">
                        <label>Time</label>
                        <div class="flex gap-sm" style="align-items: center;">
                            <input type="time" id="meeting-start">
                            <span style="color: var(--text-muted);">to</span>
                            <input type="time" id="meeting-end">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label>Project / Type</label>
                    <input type="text" id="meeting-project" placeholder="e.g. Q1 Planning">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="btn-cancel-meeting">Cancel</button>
                <button class="btn btn-primary" id="btn-save-meeting">Add Meeting</button>
            </div>
        </div>
    </div>

    <!-- Success Modal -->
    <div id="success-modal" class="success-modal">
        <div class="success-icon">‚úì</div>
        <div class="success-content">
            <h3 class="success-title">Task Scheduled!</h3>
            <div class="success-details">
                <div class="success-detail-row">
                    <span class="success-detail-label">üìÖ Date</span>
                    <span class="success-detail-value" id="success-date">-</span>
                </div>
                <div class="success-detail-row">
                    <span class="success-detail-label">üïê Time</span>
                    <span class="success-detail-value" id="success-time">-</span>
                </div>
                <div class="success-detail-row">
                    <span class="success-detail-label">‚è±Ô∏è Duration</span>
                    <span class="success-detail-value" id="success-duration">-</span>
                </div>
            </div>
            <div class="success-reason" id="success-reason">
                AI scheduling analysis will appear here
            </div>
            <div class="success-actions">
                <button class="btn btn-secondary w-100" onclick="app.closeSuccessModal()">Close</button>
                <button class="btn btn-primary w-100" onclick="app.viewCalendar()">View Calendar</button>
            </div>
        </div>
    </div>

    <script>
        // ====================================
        // DATE UTILITIES
        // ====================================
        const DateUtils = {
            getToday() {
                return new Date().toISOString().split('T')[0];
            },

            getTomorrow() {
                const d = new Date();
                d.setDate(d.getDate() + 1);
                return d.toISOString().split('T')[0];
            },

            addDays(dateStr, days) {
                const d = new Date(dateStr);
                d.setDate(d.getDate() + days);
                return d.toISOString().split('T')[0];
            },

            getMonthName(date) {
                return date.toLocaleDateString('en-US', { month: 'long' });
            },

            getDayName(dateStr) {
                const d = new Date(dateStr);
                return d.toLocaleDateString('en-US', { weekday: 'long' });
            },

            daysBetween(date1, date2) {
                const d1 = new Date(date1);
                const d2 = new Date(date2);
                const diffTime = Math.abs(d2 - d1);
                return Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            },

            isToday(dateStr) {
                return dateStr === this.getToday();
            },

            isWeekend(dateStr) {
                const d = new Date(dateStr);
                const day = d.getDay();
                return day === 0 || day === 6;
            },

            timeToMinutes(timeStr) {
                const [h, m] = timeStr.split(':').map(Number);
                return h * 60 + m;
            },

            minutesToTime(minutes) {
                const h = Math.floor(minutes / 60);
                const m = minutes % 60;
                return `${h.toString().padStart(2, '0')}:${m.toString().padStart(2, '0')}`;
            },

            timeRangesOverlap(start1, end1, start2, end2) {
                return start1 < end2 && start2 < end1;
            },

            addMinutes(timeStr, minsToAdd) {
                const mins = this.timeToMinutes(timeStr);
                return this.minutesToTime(mins + minsToAdd);
            },

            isMorning(timeStr) { const h = parseInt(timeStr.split(':')[0]); return h < 12; },
            isAfternoon(timeStr) { const h = parseInt(timeStr.split(':')[0]); return h >= 12 && h < 17; },
            isEvening(timeStr) { const h = parseInt(timeStr.split(':')[0]); return h >= 17; }
        };

        // ====================================
        // NLP UTILITIES
        // ====================================
        const NLP = {
            urgencyKeywords: {
                critical: ['urgent', 'asap', 'emergency', 'critical', 'immediately', 'now'],
                high: ['important', 'high priority', 'soon', 'quickly', 'today'],
                low: ['when possible', 'sometime', 'eventual', 'low priority', 'later']
            },

            effortKeywords: {
                quick: ['quick', 'brief', 'short', '15 min', '30 min', 'send', 'email'],
                short: ['hour', '1 hour', 'one hour'],
                medium: ['couple hours', 'few hours', '2-3 hours', 'half day'],
                long: ['thorough', 'comprehensive', 'detailed', 'deep dive', 'all day', 'complete'],
            },

            taskTypeKeywords: {
                preparation: ['prepare', 'prep', 'ready', 'plan for', 'create for', 'before'],
                followUp: ['follow up', 'action items', 'after', 'post', 'review from'],
                research: ['research', 'investigate', 'analyze', 'study', 'explore'],
                creative: ['create', 'design', 'write', 'draft', 'develop'],
                administrative: ['email', 'invoice', 'update', 'organize', 'schedule', 'send']
            },

            detectUrgency(text) {
                const lowerText = text.toLowerCase();
                for (const keyword of this.urgencyKeywords.critical) {
                    if (lowerText.includes(keyword)) return 'Critical';
                }
                for (const keyword of this.urgencyKeywords.high) {
                    if (lowerText.includes(keyword)) return 'High';
                }
                for (const keyword of this.urgencyKeywords.low) {
                    if (lowerText.includes(keyword)) return 'Low';
                }
                return 'Medium';
            },

            estimateEffort(text) {
                const lowerText = text.toLowerCase();
                for (const keyword of this.effortKeywords.quick) {
                    if (lowerText.includes(keyword)) return { level: 'Quick', minutes: 30, display: '15-30 min' };
                }
                for (const keyword of this.effortKeywords.short) {
                    if (lowerText.includes(keyword)) return { level: 'Short', minutes: 60, display: '30-60 min' };
                }
                for (const keyword of this.effortKeywords.long) {
                    if (lowerText.includes(keyword)) return { level: 'Long', minutes: 180, display: '2-4 hours' };
                }
                return { level: 'Short', minutes: 60, display: '30-60 min' };
            },

            detectComplexity(text) {
                const lowerText = text.toLowerCase();
                if (lowerText.includes('complex') || lowerText.includes('difficult')) return 'Complex';
                if (lowerText.includes('simple') || lowerText.includes('easy')) return 'Simple';
                const effort = this.estimateEffort(text);
                if (effort.minutes >= 120) return 'Complex';
                if (effort.minutes <= 30) return 'Simple';
                return 'Moderate';
            },

            detectTaskType(text) {
                const lowerText = text.toLowerCase();
                for (const keyword of this.taskTypeKeywords.preparation) {
                    if (lowerText.includes(keyword)) return 'Preparation';
                }
                for (const keyword of this.taskTypeKeywords.administrative) {
                    if (lowerText.includes(keyword)) return 'Administrative';
                }
                return 'Work';
            },

            requiresFocus(text, complexity) {
                return complexity === 'Complex' || text.toLowerCase().includes('focus');
            },

            matchToMeeting(text, meetings) {
                const lowerText = text.toLowerCase();
                for (const meeting of meetings) {
                    if (lowerText.includes(meeting.title.toLowerCase()) || 
                        (meeting.project && lowerText.includes(meeting.project.toLowerCase()))) {
                        return meeting;
                    }
                }
                return null;
            }
        };

        // ====================================
        // MODELS
        // ====================================
        class Meeting {
            constructor({ id = null, title = '', date = '', startTime = '', endTime = '', project = '' }) {
                this.id = id || Math.random().toString(36).substr(2, 9);
                this.title = title;
                this.date = date;
                this.startTime = startTime;
                this.endTime = endTime;
                this.project = project;
            }

            getDuration() {
                const start = DateUtils.timeToMinutes(this.startTime);
                const end = DateUtils.timeToMinutes(this.endTime);
                return end - start;
            }

            toJSON() {
                return {
                    id: this.id,
                    title: this.title,
                    date: this.date,
                    startTime: this.startTime,
                    endTime: this.endTime,
                    project: this.project
                };
            }

            static fromJSON(json) {
                return new Meeting(json);
            }
        }

        class Task {
            constructor({ id = null, description = '', status = 'pending', deadline = null, scheduledSlot = null, analysis = {}, category = 'personal' }) {
                this.id = id || Math.random().toString(36).substr(2, 9);
                this.description = description;
                this.status = status;
                this.deadline = deadline;
                this.scheduledSlot = scheduledSlot;
                this.analysis = analysis;
                this.category = category;
                this.createdAt = new Date().toISOString();
            }

            complete() {
                this.status = 'completed';
            }

            schedule(date, startTime, endTime) {
                this.status = 'scheduled';
                this.scheduledSlot = { date, startTime, endTime };
            }

            getDuration() {
                if (!this.scheduledSlot) return 0;
                const start = DateUtils.timeToMinutes(this.scheduledSlot.startTime);
                const end = DateUtils.timeToMinutes(this.scheduledSlot.endTime);
                return end - start;
            }

            toJSON() {
                return {
                    id: this.id,
                    description: this.description,
                    status: this.status,
                    deadline: this.deadline,
                    scheduledSlot: this.scheduledSlot,
                    analysis: this.analysis,
                    category: this.category,
                    createdAt: this.createdAt
                };
            }

            static fromJSON(json) {
                return new Task(json);
            }

            getCategoryColor() {
                const colors = {
                    work: '#FAAF6F',
                    personal: '#B5BFB6',
                    health: '#F3B2A6',
                    finance: '#EDC483',
                    creative: '#ACA0BD',
                    learning: '#BEC8D3',
                    social: '#F3DFCD',
                    errands: '#C1C39D',
                    family: '#E5A082',
                    other: '#E1B9A1'
                };
                return colors[this.category] || colors.personal;
            }
        }

        // ====================================
        // STORAGE
        // ====================================
        const Storage = {
            saveMeetings(meetings) {
                localStorage.setItem('meetings', JSON.stringify(meetings.map(m => m.toJSON())));
            },

            loadMeetings() {
                const data = localStorage.getItem('meetings');
                if (!data) return [];
                try {
                    return JSON.parse(data).map(m => Meeting.fromJSON(m));
                } catch (e) {
                    return [];
                }
            },

            saveTasks(tasks) {
                localStorage.setItem('tasks', JSON.stringify(tasks.map(t => t.toJSON())));
            },

            loadTasks() {
                const data = localStorage.getItem('tasks');
                if (!data) return [];
                try {
                    return JSON.parse(data).map(t => Task.fromJSON(t));
                } catch (e) {
                    return [];
                }
            }
        };

        // ====================================
        // SCHEDULING ENGINE
        // ====================================
        const SchedulingEngine = {
            settings: {
                workStartTime: '10:00',
                workEndTime: '17:00',
                lunchStart: '12:00',
                lunchEnd: '13:00'
            },

            getCurrentTime() {
                const now = new Date();
                return now.getHours().toString().padStart(2, '0') + ':' + now.getMinutes().toString().padStart(2, '0');
            },

            isAfterCurrentTime(date, time) {
                const today = DateUtils.getToday();
                if (date > today) return true;
                if (date < today) return false;
                // Same day - check time
                const currentTime = this.getCurrentTime();
                return time > currentTime;
            },

            findOptimalSlot(task, meetings, existingTasks) {
                const duration = task.analysis.effort.minutes;
                const deadline = this.getDeadline(task, meetings);
                const slots = this.generateCandidateSlots(task, deadline, duration);
                
                // Filter out slots that are in the past
                const futureSlots = slots.filter(slot => 
                    this.isAfterCurrentTime(slot.date, slot.startTime)
                );
                
                const scoredSlots = futureSlots.map(slot => ({
                    ...slot,
                    score: this.scoreTimeSlot(slot, task, meetings, existingTasks)
                }));

                scoredSlots.sort((a, b) => b.score - a.score);

                const availableSlots = scoredSlots.filter(slot =>
                    !this.hasConflict(slot, meetings, existingTasks)
                );

                if (availableSlots.length === 0) {
                    return {
                        slot: null,
                        reason: 'No conflict-free slots available in your working hours'
                    };
                }

                return {
                    slot: availableSlots[0],
                    reason: this.generateReasoning(availableSlots[0], task)
                };
            },

            getDeadline(task, meetings) {
                if (task.deadline) return task.deadline;
                
                if (task.analysis.relatedMeeting) {
                    const meeting = meetings.find(m => m.id === task.analysis.relatedMeeting);
                    if (meeting) return meeting.date;
                }

                const urgencyDays = { 'Critical': 1, 'High': 3, 'Medium': 7, 'Low': 14 };
                const days = urgencyDays[task.analysis.urgency] || 7;
                return DateUtils.addDays(DateUtils.getToday(), days);
            },

            generateCandidateSlots(task, deadline, duration) {
                const slots = [];
                const today = DateUtils.getToday();
                const daysUntilDeadline = DateUtils.daysBetween(today, deadline);
                const daysToConsider = Math.min(Math.max(daysUntilDeadline, 7), 14);

                for (let dayOffset = 0; dayOffset < daysToConsider; dayOffset++) {
                    const date = DateUtils.addDays(today, dayOffset);
                    if (date > deadline) continue;
                    if (DateUtils.isWeekend(date) && task.analysis.urgency !== 'Critical') continue;

                    const daySlots = this.generateDaySlots(date, duration);
                    slots.push(...daySlots);
                }

                return slots;
            },

            generateDaySlots(date, duration) {
                const slots = [];
                const startMinutes = DateUtils.timeToMinutes(this.settings.workStartTime);
                const endMinutes = DateUtils.timeToMinutes(this.settings.workEndTime);
                const lunchStart = DateUtils.timeToMinutes(this.settings.lunchStart);
                const lunchEnd = DateUtils.timeToMinutes(this.settings.lunchEnd);

                for (let minutes = startMinutes; minutes + duration <= endMinutes; minutes += 30) {
                    const slotEnd = minutes + duration;
                    if (minutes < lunchEnd && slotEnd > lunchStart) continue;
                    if (slotEnd > endMinutes) continue;

                    slots.push({
                        date,
                        startTime: DateUtils.minutesToTime(minutes),
                        endTime: DateUtils.minutesToTime(slotEnd),
                        duration
                    });
                }

                return slots;
            },

            scoreTimeSlot(slot, task, meetings, existingTasks) {
                let score = 100;
                const analysis = task.analysis;

                if (analysis.requiresFocus && DateUtils.isMorning(slot.startTime)) {
                    score += 10;
                }

                if (analysis.complexity === 'Simple' && DateUtils.isAfternoon(slot.startTime)) {
                    score += 5;
                }

                const dayHours = this.getScheduledHours(slot.date, meetings, existingTasks);
                if (dayHours > 6) score -= 5;
                else if (dayHours < 3) score += 3;

                const urgencyBonus = { 'Critical': 20, 'High': 10, 'Medium': 0, 'Low': -5 };
                score += urgencyBonus[analysis.urgency] || 0;

                if (DateUtils.isToday(slot.date) && (analysis.urgency === 'Critical' || analysis.urgency === 'High')) {
                    score += 15;
                }

                return score;
            },

            hasConflict(slot, meetings, tasks) {
                for (const meeting of meetings) {
                    if (meeting.date === slot.date) {
                        if (DateUtils.timeRangesOverlap(slot.startTime, slot.endTime, meeting.startTime, meeting.endTime)) {
                            return true;
                        }
                    }
                }

                for (const task of tasks) {
                    if (task.scheduledSlot && task.scheduledSlot.date === slot.date) {
                        if (DateUtils.timeRangesOverlap(slot.startTime, slot.endTime, task.scheduledSlot.startTime, task.scheduledSlot.endTime)) {
                            return true;
                        }
                    }
                }

                return false;
            },

            getScheduledHours(date, meetings, tasks) {
                let totalMinutes = 0;
                meetings.forEach(m => {
                    if (m.date === date) totalMinutes += m.getDuration();
                });
                tasks.forEach(t => {
                    if (t.scheduledSlot && t.scheduledSlot.date === date) {
                        totalMinutes += t.getDuration();
                    }
                });
                return totalMinutes / 60;
            },

            generateReasoning(slot, task) {
                const parts = [];
                if (DateUtils.isMorning(slot.startTime) && task.analysis.requiresFocus) {
                    parts.push('Scheduled in morning when you\'re most focused');
                }
                if (task.analysis.urgency === 'Critical' || task.analysis.urgency === 'High') {
                    if (DateUtils.isToday(slot.date)) {
                        parts.push('Scheduled today due to high urgency');
                    }
                }
                if (parts.length === 0) {
                    parts.push('This slot provides good focus time');
                }
                return parts.join('. ') + '.';
            }
        };

        // ====================================
        // WORKLOAD ANALYZER
        // ====================================
        const WorkloadAnalyzer = {
            getWeeklyStats(meetings, tasks) {
                const today = DateUtils.getToday();
                const weekDates = [];
                for (let i = 0; i < 7; i++) {
                    weekDates.push(DateUtils.addDays(today, i));
                }

                let totalHours = 0;
                weekDates.forEach(date => {
                    totalHours += SchedulingEngine.getScheduledHours(date, meetings, tasks);
                });

                const totalTasks = tasks.length;
                const completedTasks = tasks.filter(t => t.status === 'completed').length;
                const completionRate = totalTasks > 0 ? Math.round((completedTasks / totalTasks) * 100) : 0;

                return {
                    totalHours: Math.round(totalHours * 10) / 10,
                    completionRate
                };
            },

            getDailyIntensity(meetings, tasks, days = 7) {
                const intensity = {};
                const today = DateUtils.getToday();

                for (let i = 0; i < days; i++) {
                    const date = DateUtils.addDays(today, i);
                    const hours = SchedulingEngine.getScheduledHours(date, meetings, tasks);
                    intensity[date] = {
                        hours: Math.round(hours * 10) / 10,
                        level: hours > 6 ? 'High' : hours > 4 ? 'Medium' : 'Low'
                    };
                }

                return intensity;
            },

            getNextDeadline(tasks) {
                const pendingTasks = tasks.filter(t => t.status !== 'completed' && t.deadline);
                if (pendingTasks.length === 0) return null;

                pendingTasks.sort((a, b) => a.deadline.localeCompare(b.deadline));
                const next = pendingTasks[0];

                return {
                    task: next.description,
                    date: next.deadline,
                    days: DateUtils.daysBetween(DateUtils.getToday(), next.deadline)
                };
            },

            getRecommendations(meetings, tasks) {
                const recs = [];
                const stats = this.getWeeklyStats(meetings, tasks);

                if (stats.totalHours > 40) {
                    recs.push({
                        type: 'warning',
                        text: 'High workload detected this week (>40h). Consider rescheduling non-urgent tasks.'
                    });
                }

                const urgentPending = tasks.filter(t =>
                    t.status === 'pending' &&
                    (t.analysis.urgency === 'Critical' || t.analysis.urgency === 'High')
                ).length;

                if (urgentPending > 0) {
                    recs.push({
                        type: 'action',
                        text: `You have ${urgentPending} urgent task${urgentPending > 1 ? 's' : ''} pending. Schedule them soon!`
                    });
                } else {
                    recs.push({
                        type: 'success',
                        text: 'Great job! No urgent tasks pending. Keep up the momentum!'
                    });
                }

                return recs;
            }
        };

        // ====================================
        // APP
        // ====================================
        class App {
            constructor() {
                this.meetings = Storage.loadMeetings();
                this.tasks = Storage.loadTasks();
                this.currentFilter = 'all';
                this.calendar = new Calendar();
                this.init();
            }

            init() {
                // Initialize sample data if empty
                if (this.meetings.length === 0) {
                    this.addSampleData();
                }

                this.setupNavigation();
                this.setupModals();
                this.setupTaskForm();
                this.setupMeetingForm();
                this.setupTaskFilters();
                this.refresh();
            }

            addSampleData() {
                const today = DateUtils.getToday();
                this.meetings = [
                    new Meeting({
                        title: 'Client Presentation',
                        date: DateUtils.addDays(today, 2),
                        startTime: '14:00',
                        endTime: '15:30',
                        project: 'Q1 Sales'
                    }),
                    new Meeting({
                        title: 'Team Standup',
                        date: DateUtils.getTomorrow(),
                        startTime: '09:30',
                        endTime: '10:00',
                        project: 'Development'
                    })
                ];
                Storage.saveMeetings(this.meetings);
            }

            setupNavigation() {
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.addEventListener('click', () => {
                        document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
                        item.classList.add('active');
                        
                        const view = item.dataset.view;
                        document.querySelectorAll('.view-section').forEach(v => v.classList.remove('active'));
                        document.getElementById(view + '-view').classList.add('active');
                        
                        if (view === 'dashboard') {
                            this.renderDashboard();
                        }
                    });
                });
            }

            setupModals() {
                document.getElementById('btn-add-task').addEventListener('click', () => {
                    document.getElementById('task-modal').classList.add('active');
                });

                document.getElementById('btn-add-meeting').addEventListener('click', () => {
                    document.getElementById('meeting-modal').classList.add('active');
                });

                document.querySelectorAll('.btn-close').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const modalType = e.target.dataset.close;
                        document.getElementById(modalType + '-modal').classList.remove('active');
                    });
                });

                document.getElementById('btn-cancel-task').addEventListener('click', () => {
                    document.getElementById('task-modal').classList.remove('active');
                });

                document.getElementById('btn-cancel-meeting').addEventListener('click', () => {
                    document.getElementById('meeting-modal').classList.remove('active');
                });

                // Close on backdrop click
                document.querySelectorAll('.modal-backdrop').forEach(backdrop => {
                    backdrop.addEventListener('click', (e) => {
                        if (e.target === backdrop) {
                            backdrop.classList.remove('active');
                        }
                    });
                });
            }

            setupTaskForm() {
                const input = document.getElementById('task-input');
                let timeout;

                input.addEventListener('input', (e) => {
                    clearTimeout(timeout);
                    timeout = setTimeout(() => {
                        this.analyzeTaskInput(e.target.value);
                    }, 300);
                });

                // Category selector
                document.querySelectorAll('.category-option').forEach(option => {
                    option.addEventListener('click', () => {
                        document.querySelectorAll('.category-option').forEach(o => o.classList.remove('selected'));
                        option.classList.add('selected');
                    });
                });

                document.getElementById('btn-save-task').addEventListener('click', () => {
                    this.saveTask();
                });
            }

            analyzeTaskInput(text) {
                const preview = document.getElementById('analysis-preview');
                
                if (text.length < 5) {
                    preview.classList.add('hidden');
                    return;
                }

                const effort = NLP.estimateEffort(text);
                const urgency = NLP.detectUrgency(text);
                const taskType = NLP.detectTaskType(text);
                const complexity = NLP.detectComplexity(text);

                preview.classList.remove('hidden');
                
                const urgencyBadge = document.getElementById('preview-urgency');
                urgencyBadge.textContent = urgency;
                urgencyBadge.className = `badge badge-${urgency.toLowerCase()}`;

                document.getElementById('preview-type').textContent = taskType;
                document.getElementById('preview-effort').textContent = effort.display;
                document.getElementById('preview-suggestion').textContent = 
                    `Estimated effort: ${effort.display}. Complexity: ${complexity}.`;
            }

            saveTask() {
                const description = document.getElementById('task-input').value.trim();
                const deadline = document.getElementById('task-deadline').value;
                const selectedCategory = document.querySelector('.category-option.selected');
                const category = selectedCategory ? selectedCategory.dataset.category : 'personal';

                if (!description) return;

                const task = new Task({ description, deadline: deadline || null, category });
                
                task.analysis = {
                    urgency: NLP.detectUrgency(description),
                    effort: NLP.estimateEffort(description),
                    taskType: NLP.detectTaskType(description),
                    complexity: NLP.detectComplexity(description),
                    requiresFocus: NLP.requiresFocus(description, NLP.detectComplexity(description)),
                    relatedMeeting: NLP.matchToMeeting(description, this.meetings)?.id || null
                };

                const result = SchedulingEngine.findOptimalSlot(task, this.meetings, this.tasks);

                if (result.slot) {
                    task.schedule(result.slot.date, result.slot.startTime, result.slot.endTime);
                    this.showSuccessModal(task, result);
                } else {
                    alert(`‚ö†Ô∏è Could not auto-schedule.\n\nReason: ${result.reason}\nTask added to pending list.`);
                }

                this.tasks.push(task);
                Storage.saveTasks(this.tasks);
                
                document.getElementById('task-input').value = '';
                document.getElementById('task-deadline').value = '';
                document.getElementById('analysis-preview').classList.add('hidden');
                // Reset to default category
                document.querySelectorAll('.category-option').forEach(o => o.classList.remove('selected'));
                document.querySelector('[data-category="personal"]').classList.add('selected');
                document.getElementById('task-modal').classList.remove('active');
                
                this.refresh();
            }

            showSuccessModal(task, result) {
                const modal = document.getElementById('success-modal');
                
                document.getElementById('success-date').textContent = 
                    new Date(result.slot.date).toLocaleDateString('en-US', { 
                        weekday: 'short', 
                        month: 'short', 
                        day: 'numeric' 
                    });
                
                document.getElementById('success-time').textContent = 
                    `${result.slot.startTime} - ${result.slot.endTime}`;
                
                document.getElementById('success-duration').textContent = 
                    task.analysis.effort.display;
                
                document.getElementById('success-reason').textContent = result.reason;
                
                modal.classList.add('active');
                
                // Auto-close after 5 seconds
                setTimeout(() => {
                    if (modal.classList.contains('active')) {
                        this.closeSuccessModal();
                    }
                }, 5000);
            }

            closeSuccessModal() {
                document.getElementById('success-modal').classList.remove('active');
            }

            viewCalendar() {
                this.closeSuccessModal();
                document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
                document.querySelector('[data-view="calendar"]').classList.add('active');
                document.querySelectorAll('.view-section').forEach(v => v.classList.remove('active'));
                document.getElementById('calendar-view').classList.add('active');
            }

            setupMeetingForm() {
                document.getElementById('btn-save-meeting').addEventListener('click', () => {
                    this.saveMeeting();
                });
            }

            saveMeeting() {
                const title = document.getElementById('meeting-title').value.trim();
                const date = document.getElementById('meeting-date').value;
                const startTime = document.getElementById('meeting-start').value;
                const endTime = document.getElementById('meeting-end').value;
                const project = document.getElementById('meeting-project').value.trim();

                if (!title || !date || !startTime || !endTime) {
                    alert('Please fill in all required fields');
                    return;
                }

                const modal = document.getElementById('meeting-modal');
                const editId = modal.dataset.editId;

                if (editId) {
                    // Update existing meeting
                    const meeting = this.meetings.find(m => m.id === editId);
                    if (meeting) {
                        meeting.title = title;
                        meeting.date = date;
                        meeting.startTime = startTime;
                        meeting.endTime = endTime;
                        meeting.project = project;
                    }
                    delete modal.dataset.editId;
                    document.getElementById('btn-save-meeting').textContent = 'Add Meeting';
                } else {
                    // Create new meeting
                    const meeting = new Meeting({ title, date, startTime, endTime, project });
                    this.meetings.push(meeting);
                }

                Storage.saveMeetings(this.meetings);

                document.getElementById('meeting-title').value = '';
                document.getElementById('meeting-date').value = '';
                document.getElementById('meeting-start').value = '';
                document.getElementById('meeting-end').value = '';
                document.getElementById('meeting-project').value = '';
                modal.classList.remove('active');

                this.refresh();
            }

            setupTaskFilters() {
                document.querySelectorAll('.filter-controls .badge').forEach(badge => {
                    badge.addEventListener('click', (e) => {
                        document.querySelectorAll('.filter-controls .badge').forEach(b => 
                            b.classList.remove('badge-active'));
                        e.target.classList.add('badge-active');
                        this.currentFilter = e.target.dataset.filter;
                        this.renderTasks();
                    });
                });
            }

            refresh() {
                this.calendar.render(this.meetings, this.tasks);
                this.renderTasks();
                this.renderDashboard();
            }

            renderTasks() {
                const container = document.getElementById('task-list');
                let filteredTasks = this.tasks;

                if (this.currentFilter !== 'all') {
                    filteredTasks = this.tasks.filter(t => t.status === this.currentFilter);
                }

                if (filteredTasks.length === 0) {
                    container.innerHTML = '<div class="empty-state">No tasks to display</div>';
                    return;
                }

                container.innerHTML = filteredTasks.map(task => {
                    const categoryColor = task.getCategoryColor();
                    const categoryClass = `category-${task.category}`;
                    return `
                    <div class="task-item" style="border-left: 4px solid ${categoryColor}">
                        <div class="task-header">
                            <div class="task-description">${task.description}</div>
                            <div style="display: flex; gap: 0.5rem; align-items: center;">
                                <span class="badge ${categoryClass}" style="font-size: 0.7rem;">${task.category}</span>
                                <span class="badge badge-${task.analysis.urgency?.toLowerCase() || 'medium'}">
                                    ${task.analysis.urgency || 'Medium'}
                                </span>
                            </div>
                        </div>
                        <div class="task-meta">
                            ${task.scheduledSlot ? 
                                `<span>üìÖ ${task.scheduledSlot.date} at ${task.scheduledSlot.startTime}</span>` : 
                                '<span>‚è≥ Not scheduled</span>'}
                            ${task.deadline ? `<span>‚è∞ Due: ${task.deadline}</span>` : ''}
                            <span>${task.analysis.effort?.display || '1h'}</span>
                        </div>
                        <div class="task-actions">
                            ${task.status !== 'completed' ? 
                                `<button class="btn btn-sm btn-primary" onclick="app.completeTask('${task.id}')">
                                    ‚úì Complete
                                </button>` : 
                                '<span class="badge badge-active">‚úì Completed</span>'}
                            <button class="btn btn-sm btn-secondary" onclick="app.deleteTask('${task.id}')">
                                Delete
                            </button>
                        </div>
                    </div>
                `}).join('');
            }

            completeTask(id) {
                const task = this.tasks.find(t => t.id === id);
                if (task) {
                    task.complete();
                    Storage.saveTasks(this.tasks);
                    this.refresh();
                }
            }

            deleteTask(id) {
                if (confirm('Delete this task?')) {
                    this.tasks = this.tasks.filter(t => t.id !== id);
                    Storage.saveTasks(this.tasks);
                    this.refresh();
                }
            }

            deleteMeeting(id) {
                if (confirm('Delete this meeting?')) {
                    this.meetings = this.meetings.filter(m => m.id !== id);
                    Storage.saveMeetings(this.meetings);
                    this.refresh();
                }
            }

            editMeeting(id) {
                const meeting = this.meetings.find(m => m.id === id);
                if (!meeting) return;

                document.getElementById('meeting-title').value = meeting.title;
                document.getElementById('meeting-date').value = meeting.date;
                document.getElementById('meeting-start').value = meeting.startTime;
                document.getElementById('meeting-end').value = meeting.endTime;
                document.getElementById('meeting-project').value = meeting.project || '';
                
                // Store the ID for update
                document.getElementById('meeting-modal').dataset.editId = id;
                document.getElementById('btn-save-meeting').textContent = 'Update Meeting';
                document.getElementById('meeting-modal').classList.add('active');
            }

            renderDashboard() {
                const stats = WorkloadAnalyzer.getWeeklyStats(this.meetings, this.tasks);
                const recommendations = WorkloadAnalyzer.getRecommendations(this.meetings, this.tasks);
                const nextDeadline = WorkloadAnalyzer.getNextDeadline(this.tasks);

                document.getElementById('stat-weekly-hours').textContent = `${stats.totalHours}h`;
                document.getElementById('stat-completion').textContent = `${stats.completionRate}%`;

                const deadlineEl = document.getElementById('stat-next-deadline');
                if (nextDeadline) {
                    deadlineEl.innerHTML = `<strong style="font-size: 1rem;">${nextDeadline.task.substring(0, 30)}...</strong><br><span style="font-size: 0.875rem;">${nextDeadline.date} (${nextDeadline.days} days)</span>`;
                } else {
                    deadlineEl.textContent = 'No deadlines';
                }

                const recList = document.getElementById('recommendations-list');
                if (recommendations.length === 0) {
                    recList.innerHTML = '<div class="rec-item">All good! You\'re on track.</div>';
                } else {
                    recList.innerHTML = recommendations.map(rec => 
                        `<div class="rec-item ${rec.type}">${rec.text}</div>`
                    ).join('');
                }

                this.renderIntensityChart();
            }

            renderIntensityChart() {
                const intensity = WorkloadAnalyzer.getDailyIntensity(this.meetings, this.tasks, 7);
                const container = document.getElementById('intensity-chart');
                container.innerHTML = '';

                Object.keys(intensity).forEach(date => {
                    const data = intensity[date];
                    const dayName = DateUtils.getDayName(date).substring(0, 3);
                    
                    const barContainer = document.createElement('div');
                    barContainer.style.cssText = 'flex: 1; display: flex; flex-direction: column; align-items: center; gap: 5px;';

                    const bar = document.createElement('div');
                    const height = Math.min(data.hours * 15, 100);
                    const color = data.hours > 6 ? 'var(--critical)' : data.hours > 4 ? 'var(--high)' : 'var(--accent-primary)';
                    bar.style.cssText = `width: 100%; height: ${height}%; background: ${color}; border-radius: 6px; transition: height 0.5s;`;

                    const label = document.createElement('div');
                    label.textContent = dayName;
                    label.style.cssText = 'font-size: 0.75rem; color: var(--text-muted);';

                    barContainer.appendChild(bar);
                    barContainer.appendChild(label);
                    container.appendChild(barContainer);
                });
            }
        }

        // ====================================
        // CALENDAR COMPONENT
        // ====================================
        class Calendar {
            constructor() {
                this.view = 'month';
                this.currentDate = new Date();
                this.setupListeners();
            }

            setupListeners() {
                document.getElementById('cal-prev').addEventListener('click', () => {
                    if (this.view === 'month') {
                        this.currentDate.setMonth(this.currentDate.getMonth() - 1);
                    } else if (this.view === 'week') {
                        this.currentDate.setDate(this.currentDate.getDate() - 7);
                    } else if (this.view === 'day') {
                        this.currentDate.setDate(this.currentDate.getDate() - 1);
                    }
                    this.render(app.meetings, app.tasks);
                });

                document.getElementById('cal-next').addEventListener('click', () => {
                    if (this.view === 'month') {
                        this.currentDate.setMonth(this.currentDate.getMonth() + 1);
                    } else if (this.view === 'week') {
                        this.currentDate.setDate(this.currentDate.getDate() + 7);
                    } else if (this.view === 'day') {
                        this.currentDate.setDate(this.currentDate.getDate() + 1);
                    }
                    this.render(app.meetings, app.tasks);
                });

                document.querySelectorAll('[data-cal-view]').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        document.querySelectorAll('[data-cal-view]').forEach(b => b.classList.remove('active'));
                        e.target.classList.add('active');
                        this.view = e.target.dataset.calView;
                        this.render(app.meetings, app.tasks);
                    });
                });
            }

            render(meetings, tasks) {
                const grid = document.getElementById('calendar-grid');
                const header = document.getElementById('current-month-display');

                header.textContent = `${DateUtils.getMonthName(this.currentDate)} ${this.currentDate.getFullYear()}`;

                if (this.view !== 'month') {
                    grid.innerHTML = '<div class="empty-state" style="grid-column: 1/-1;">Week and Day views coming soon!</div>';
                    return;
                }

                this.renderMonthView(grid, meetings, tasks);
            }

            render(meetings, tasks) {
                const grid = document.getElementById('calendar-grid');
                const header = document.getElementById('current-month-display');

                switch (this.view) {
                    case 'month':
                        header.textContent = `${DateUtils.getMonthName(this.currentDate)} ${this.currentDate.getFullYear()}`;
                        this.renderMonthView(grid, meetings, tasks);
                        break;
                    case 'week':
                        const weekStart = this.getWeekStart(this.currentDate);
                        const weekEnd = this.getWeekEnd(this.currentDate);
                        header.textContent = `${DateUtils.getMonthName(weekStart)} ${weekStart.getDate()} - ${DateUtils.getMonthName(weekEnd)} ${weekEnd.getDate()}, ${this.currentDate.getFullYear()}`;
                        this.renderWeekView(grid, meetings, tasks);
                        break;
                    case 'day':
                        header.textContent = `${DateUtils.getDayName(this.currentDate.toISOString().split('T')[0])} - ${DateUtils.getMonthName(this.currentDate)} ${this.currentDate.getDate()}, ${this.currentDate.getFullYear()}`;
                        this.renderDayView(grid, meetings, tasks);
                        break;
                }
            }

            getWeekStart(date) {
                const d = new Date(date);
                const day = d.getDay();
                const diff = d.getDate() - day; // Sunday
                return new Date(d.setDate(diff));
            }

            getWeekEnd(date) {
                const start = this.getWeekStart(date);
                return new Date(start.getTime() + 6 * 24 * 60 * 60 * 1000);
            }

            renderMonthView(container, meetings, tasks) {
                container.innerHTML = '';
                container.className = 'calendar-grid';
                container.style.gridTemplateColumns = 'repeat(7, 1fr)';
                
                const year = this.currentDate.getFullYear();
                const month = this.currentDate.getMonth();

                const firstDay = new Date(year, month, 1);
                const lastDay = new Date(year, month + 1, 0);
                const startDayIndex = firstDay.getDay();
                const totalDays = lastDay.getDate();

                const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
                days.forEach(d => {
                    const el = document.createElement('div');
                    el.className = 'calendar-day-header';
                    el.textContent = d;
                    container.appendChild(el);
                });

                for (let i = 0; i < startDayIndex; i++) {
                    const el = document.createElement('div');
                    el.className = 'calendar-day';
                    el.style.opacity = '0.3';
                    container.appendChild(el);
                }

                for (let day = 1; day <= totalDays; day++) {
                    const dateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                    const el = document.createElement('div');
                    el.className = `calendar-day ${DateUtils.isToday(dateStr) ? 'today' : ''}`;
                    el.innerHTML = `<span class="day-number">${day}</span>`;

                    const dayMeetings = meetings.filter(m => m.date === dateStr);
                    dayMeetings.forEach(m => {
                        const pill = this.createMeetingPill(m);
                        el.appendChild(pill);
                    });

                    const dayTasks = tasks.filter(t => t.scheduledSlot && t.scheduledSlot.date === dateStr);
                    dayTasks.forEach(t => {
                        const pill = this.createTaskPill(t);
                        el.appendChild(pill);
                    });

                    container.appendChild(el);
                }
            }

            renderWeekView(container, meetings, tasks) {
                container.innerHTML = '';
                container.className = 'week-view-grid';
                container.style.gridTemplateColumns = 'auto repeat(7, 1fr)';

                const weekStart = this.getWeekStart(this.currentDate);
                const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
                
                // Time column header
                const timeHeader = document.createElement('div');
                timeHeader.className = 'week-time-header';
                timeHeader.textContent = 'Time';
                container.appendChild(timeHeader);

                // Day headers
                for (let i = 0; i < 7; i++) {
                    const date = new Date(weekStart);
                    date.setDate(weekStart.getDate() + i);
                    const dateStr = date.toISOString().split('T')[0];
                    
                    const header = document.createElement('div');
                    header.className = `week-day-header ${DateUtils.isToday(dateStr) ? 'today' : ''}`;
                    header.innerHTML = `
                        <div style="font-weight: 700; font-size: 1.1rem;">${days[i]}</div>
                        <div style="font-size: 0.875rem; color: var(--text-muted);">${date.getDate()}</div>
                    `;
                    container.appendChild(header);
                }

                // Time slots (10am to 5pm)
                for (let hour = 10; hour < 17; hour++) {
                    // Time label
                    const timeLabel = document.createElement('div');
                    timeLabel.className = 'week-time-slot';
                    timeLabel.textContent = `${hour}:00`;
                    container.appendChild(timeLabel);

                    // Day columns
                    for (let i = 0; i < 7; i++) {
                        const date = new Date(weekStart);
                        date.setDate(weekStart.getDate() + i);
                        const dateStr = date.toISOString().split('T')[0];
                        
                        const slot = document.createElement('div');
                        slot.className = `week-slot ${DateUtils.isToday(dateStr) ? 'today-slot' : ''}`;
                        
                        // Find events in this hour
                        const hourStr = `${String(hour).padStart(2, '0')}:00`;
                        const nextHourStr = `${String(hour + 1).padStart(2, '0')}:00`;
                        
                        const hourMeetings = meetings.filter(m => 
                            m.date === dateStr && 
                            m.startTime >= hourStr && 
                            m.startTime < nextHourStr
                        );
                        
                        hourMeetings.forEach(m => {
                            const pill = this.createMeetingPill(m, true);
                            slot.appendChild(pill);
                        });

                        const hourTasks = tasks.filter(t => 
                            t.scheduledSlot && 
                            t.scheduledSlot.date === dateStr && 
                            t.scheduledSlot.startTime >= hourStr && 
                            t.scheduledSlot.startTime < nextHourStr
                        );
                        
                        hourTasks.forEach(t => {
                            const pill = this.createTaskPill(t, true);
                            slot.appendChild(pill);
                        });

                        container.appendChild(slot);
                    }
                }
            }

            renderDayView(container, meetings, tasks) {
                container.innerHTML = '';
                container.className = 'day-view-grid';
                container.style.gridTemplateColumns = '80px 1fr';

                const dateStr = this.currentDate.toISOString().split('T')[0];

                // Time slots (10am to 5pm)
                for (let hour = 10; hour < 17; hour++) {
                    // Time label
                    const timeLabel = document.createElement('div');
                    timeLabel.className = 'day-time-slot';
                    timeLabel.textContent = `${hour}:00`;
                    container.appendChild(timeLabel);

                    // Event slot
                    const slot = document.createElement('div');
                    slot.className = 'day-slot';
                    
                    const hourStr = `${String(hour).padStart(2, '0')}:00`;
                    const nextHourStr = `${String(hour + 1).padStart(2, '0')}:00`;
                    
                    const hourMeetings = meetings.filter(m => 
                        m.date === dateStr && 
                        m.startTime >= hourStr && 
                        m.startTime < nextHourStr
                    );
                    
                    hourMeetings.forEach(m => {
                        const pill = this.createMeetingPill(m, true);
                        pill.style.marginBottom = '0.5rem';
                        slot.appendChild(pill);
                    });

                    const hourTasks = tasks.filter(t => 
                        t.scheduledSlot && 
                        t.scheduledSlot.date === dateStr && 
                        t.scheduledSlot.startTime >= hourStr && 
                        t.scheduledSlot.startTime < nextHourStr
                    );
                    
                    hourTasks.forEach(t => {
                        const pill = this.createTaskPill(t, true);
                        pill.style.marginBottom = '0.5rem';
                        slot.appendChild(pill);
                    });

                    if (hourMeetings.length === 0 && hourTasks.length === 0) {
                        slot.innerHTML = '<span style="color: var(--text-muted); font-size: 0.75rem;">Available</span>';
                    }

                    container.appendChild(slot);
                }
            }

            createMeetingPill(meeting, detailed = false) {
                const pill = document.createElement('div');
                pill.className = 'event-pill';
                
                const content = document.createElement('span');
                content.className = 'event-pill-content';
                if (detailed) {
                    content.innerHTML = `<strong>${meeting.startTime}</strong> - ${meeting.title}${meeting.project ? ` (${meeting.project})` : ''}`;
                } else {
                    content.textContent = `üìÖ ${meeting.startTime} ${meeting.title}`;
                }
                pill.appendChild(content);

                const deleteBtn = document.createElement('button');
                deleteBtn.className = 'event-delete-btn';
                deleteBtn.innerHTML = '√ó';
                deleteBtn.title = 'Delete meeting';
                deleteBtn.onclick = (e) => {
                    e.stopPropagation();
                    app.deleteMeeting(meeting.id);
                };
                pill.appendChild(deleteBtn);

                pill.onclick = () => {
                    app.editMeeting(meeting.id);
                };

                return pill;
            }

            createTaskPill(task, detailed = false) {
                const pill = document.createElement('div');
                const categoryColor = task.getCategoryColor();
                pill.className = `event-pill task-pill ${task.analysis.urgency === 'Critical' ? 'urgent' : ''}`;
                pill.style.background = categoryColor;
                pill.style.color = ['#ACA0BD'].includes(categoryColor) ? '#fff' : '#000';
                pill.style.borderLeftColor = categoryColor;
                pill.style.filter = 'brightness(0.9)';
                
                const content = document.createElement('span');
                content.className = 'event-pill-content';
                if (detailed) {
                    content.innerHTML = `<strong>${task.scheduledSlot.startTime}</strong> - ${task.description}`;
                } else {
                    content.textContent = `‚úÖ ${task.scheduledSlot.startTime} ${task.description.substring(0, 20)}`;
                }
                pill.appendChild(content);

                const deleteBtn = document.createElement('button');
                deleteBtn.className = 'event-delete-btn';
                deleteBtn.innerHTML = '√ó';
                deleteBtn.title = task.status === 'completed' ? 'Delete task' : 'Complete or delete task';
                deleteBtn.onclick = (e) => {
                    e.stopPropagation();
                    if (task.status === 'completed') {
                        app.deleteTask(task.id);
                    } else {
                        if (confirm('Mark as complete or delete?\n\nOK = Complete\nCancel = Delete')) {
                            app.completeTask(task.id);
                        } else {
                            app.deleteTask(task.id);
                        }
                    }
                };
                pill.appendChild(deleteBtn);

                return pill;
            }

            showMeetingMenu(meeting, element) {
                // This method is no longer used but kept for compatibility
            }

            showTaskMenu(task, element) {
                // This method is no longer used but kept for compatibility
            }
        }

        // ====================================
        // INITIALIZE APP
        // ====================================
        let app;
        window.addEventListener('DOMContentLoaded', () => {
            app = new App();
        });
    </script>
</body>
</html>
